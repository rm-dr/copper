[input]
type = "File"

[output]
node.type = "Dataset"
node.class = "AudioFile"
node.attr."album" = "text"
node.attr."artist" = "text"
node.attr."albumartist" = "text"
node.attr."tracknumber" = "text"
node.attr."year" = "text"
node.attr."genre" = "text"
node.attr."ISRC" = "text"
node.attr."lyrics" = "text"
node.attr."audio_data" = "binary"

input."album" = { node = "tags", output = "Album" }
input."artist" = { node = "tags", output = "Artist" }
input."albumartist" = { node = "tags", output = "AlbumArtist" }
input."tracknumber" = { node = "tags", output = "TrackNumber" }
input."year" = { node = "tags", output = "Year" }
input."genre" = { node = "tags", output = "Genre" }
input."ISRC" = { node = "tags", output = "ISRC" }
input."lyrics" = { node = "if_none", output = "out" }
input."audio_data" = { node = "strip", output = "out" }


[node."tags"]
node.type = "ExtractTags"
node.tags = [
	"Album",
	"Artist",
	"AlbumArtist",
	"TrackNumber",
	"Year",
	"Genre",
	"ISRC",
	"Lyrics",
]
input.data = { "pipeline" = "data" }

[node.if_none]
node.type = "IfNone"
input."data" = { node = "tags", output = "Lyrics" }
input."ifnone" = { type = "Constant", value = "Unknown Lyrics" }

[node.strip]
node.type = "StripTags"
input."data" = { pipeline = "data" }
#after = ["add_cover"]

[node."extract_cover"]
node.type = "ExtractCovers"
input."data" = { pipeline = "data" }

#[node."add_cover"]
#node.type = "Pipeline"
#node.pipeline = "cover"
#input."cover_data" = { node = "extract_cover", output = "cover_data" }

#[node."print"]
#node.type = "Print"
#input."data" = { node = "add_cover", output = "added_item" }
